<style type="text/css">
    table,
    th,
    td {
        border: solid 1px black;
        padding: 15px;
        text-align: left;
    }
</style>
<div class="flex-container">
    <div class="flex-empty"></div>
    <div class="flex-content">
        <h1>{{ data.title }}</h1>
        <div>
            <table class="table table-striped table-sm">
                <thead>
                    <tr>
                        <th scope="col">
                            <h4>Property</h4>
                        </th>
                        <th scope="col">
                            <h4>Value</h4>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <h6>Id:</h6>
                        </td>
                        <td><b>{{ data.attractionItem._id }}</b></td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Name:</h6>
                        </td>
                        <td>{{ data.attractionItem.name }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Short description:</h6>
                        </td>
                        <td>{{ data.attractionItem.short_description }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Images:</h6>
                        </td>
                        <td>
                            <ul>
                                {{#each data.attractionItem.image}}
                                <img width="320" height="250" src="{{this}}" alt="The image can't be loaded">
                                {{/each}}
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Duration:</h6>
                        </td>
                        <td>
                            <b>Min duration:</b> {{data.attractionItem.duration.min_duration}}<br />
                            <b>Max duration:</b> {{data.attractionItem.duration.max_duration}}<br />
                            <b>Average:</b> {{data.attractionItem.duration.average}}
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h6>City:</h6>
                        </td>
                        <td>{{ data.attractionItem.city }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Country:</h6>
                        </td>
                        <td>{{ data.attractionItem.country }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Continent:</h6>
                        </td>
                        <td>{{ data.attractionItem.continent }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Average cost:</h6>
                        </td>
                        <td>{{ data.attractionItem.average_cost }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Pick up included:</h6>
                        </td>
                        <td>{{ data.attractionItem.pick_up_included }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Refundable:</h6>
                        </td>
                        <td>{{ data.attractionItem.refundable }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Description:</h6>
                        </td>
                        <td>{{ data.attractionItem.description }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Included:</h6>
                        </td>
                        <td>
                            <ul>
                                {{#each data.attractionItem.included}}
                                <li>{{this}}</li>
                                {{/each}}
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Not included:</h6>
                        </td>
                        <td>
                            <ul>
                                {{#each data.attractionItem.not_included}}
                                <li>{{this}}</li>
                                {{/each}}
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Accessibility:</h6>
                        </td>
                        <td>
                            <ul>
                                {{#each data.attractionItem.accessibility}}
                                <li>{{this}}</li>
                                {{/each}}
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Health safety:</h6>
                        </td>
                        <td>
                            <ul>
                                {{#each data.attractionItem.health_safety}}
                                <li>{{this}}</li>
                                {{/each}}
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Why visit?:</h6>
                        </td>
                        <td>
                            <ul>
                                {{#each data.attractionItem.whyvisit}}
                                <li>{{this}}</li>
                                {{/each}}
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Restriction:</h6>
                        </td>
                        <td>
                            <ul>
                                {{#each data.attractionItem.restriction}}
                                <li>{{this}}</li>
                                {{/each}}
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Languages:</h6>
                        </td>
                        <td>
                            <ul>
                                {{#each data.attractionItem.languages}}
                                <li>{{this}}</li>
                                {{/each}}
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Additional_information:</h6>
                        </td>
                        <td>{{ data.attractionItem.additional_information }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Location_departure:</h6>
                        </td>
                        <td>{{ data.attractionItem.location_departure }}</td>
                    </tr>
                    <tr>
                        <td>
                            <h6>Itinerary_stops:</h6>
                        </td>
                        <td>
                            <ul>
                                {{#each data.attractionItem.itinerary_stops}}
                                <li>
                                    <b>Name:</b> {{name}}
                                </li>
                                <li>
                                    <b>Admission ticket:</b> {{admission_ticket}}
                                </li>
                                <li>
                                    <b>Description:</b> {{description}}
                                </li>
                                <li>
                                    <b>Duration:</b> {{duration}}
                                </li>
                                <p>----------------</p>
                                {{/each}}
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <button class="btn btn-outline-primary w-100" type="button" data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">Comments</button>

        <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
            <div class="offcanvas-header" style="padding-bottom: 0;">
                <h4 id="offcanvasRightLabel">Comments</h4>
                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"
                    aria-label="Close"></button>
            </div>
            <div class="offcanvas-body" style="padding-top: 5;">
                <div class="container">
                    <div class="row">
                        <div class="">

                            <!-- Button trigger modal -->
                            <button type="button" class="btn btn-outline-primary w-100" data-bs-toggle="modal"
                                data-bs-target="#staticBackdrop">
                                Add a comment
                            </button>

                            {{#each comments}}
                            <div class="line"></div>
                            <div class="comment mt-4 text-justify float-left w-100"
                                style=" border-top-width: inherit; border-top-styles:solid;">
                                {{!-- <h4> --}}
                                    <img src="{{ avatar }}" alt="" class="rounded-circle" width="40" height="40"> {{
                                    user_name }}
                                    - <span class="createdAt">{{createdat}}</span>
                                    {{!--
                                </h4> --}}

                                <br>
                                <p>{{comment}}</p>
                            </div>
                            {{/each}}


                            {{!-- <div class="line"></div>
                            <div class="comment mt-4 text-justify float-left w-100">
                                <img src="https://i.imgur.com/yTFUilP.jpg" alt="" class="rounded-circle" width="40"
                                    height="40">Jhon
                                Doe</h4>
                                <span>- 20 October, 2018</span>
                                <br>
                                <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Accusamus numquam
                                    assumenda hic aliquam vero sequi velit molestias doloremque molestiae dicta?</p>
                            </div> --}}




                            <div class="line"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Button trigger modal -->


        <!-- Modal -->
        {{#if user}}
        <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
            aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <form method="POST" action="/attraction/attractionDetail/{{ data.attractionItem._id }}/comment">
                    <div class="modal-content">
                        <input type="hidden" name="user_id" value={{ user._id }}>
                        <input type="hidden" name="user_name" value={{ user.name }}>
                        <input type="hidden" name="avatar" value={{ user.avatar }}>
                        <input type="hidden" name="activities_id" value={{ data.attractionItem._id }}>
                        {{!-- <div>
                            {{ user._id }},{{ user.name }},{{ user.avatar }}
                        </div> --}}
                        <div class="modal-header">
                            <h5 class="modal-title" id="staticBackdropLabel">Add Comment</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="mb-3">
                                <label for="rating" class="form-label">Rating(1-5)</label>
                                <input min="0" max="5" name='rating' type="number" class="form-control" id="rating"
                                    placeholder="rating" required>
                            </div>
                            <div class="mb-3">
                                <label for="comment" class="form-label">Comment</label>
                                <textarea name='comment' class="form-control" id="comment" rows="5"
                                    placeholder="Enter your comment" required></textarea>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary">Submit</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        {{else}}
        <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
            aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">Waring</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        You must login to comment
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <form id="login_req" method="GET" action="/login" onsubmit="LoggingIn(event)">
                            <input type="hidden" id="previous_page" name="previous_page" value="#">
                            <button type="submit" class="btn btn-primary">Login</button>
                        </form>

                    </div>
                </div>
            </div>
        </div>
        {{/if}}
    </div>
    <div class="flex-empty"></div>
</div>

<script>
    // document.getElementById("previous_page").value = window.location.href;
    $(document).ready(function () {
        $('#previous_page').val(window.location.href)

        $('.createdAt').each(function () {
            var dateString = $(this).text();
            var dateObject = new Date(dateString);
            var formattedDate = $.datepicker.formatDate("dd MM, yy", dateObject);
            $(this).text(formattedDate);
        });
    });
</script>